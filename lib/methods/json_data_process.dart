class DataProcess {
  late Map<dynamic, dynamic> _jsonMp;
  late String _mode;
  List list = [];

  DataProcess(Map<dynamic, dynamic> jsonMp, String mode) {
    _jsonMp = jsonMp;
    _mode = mode;
    list = _getList();
  }

  List<dynamic> _getList() {
    if (_mode == "scan_url") {
      return _getListResultOfURL();
    }
    var temp = _jsonMp['data']['attributes']['last_analysis_results'];
    var temp2 = {};
    List lis = [];
    List lis2 = [];
    List lis3 = [];
    Map map = {};
    temp.forEach((key, value) {
      temp2 = value;
      map.putIfAbsent(key, () => temp2['category']);
      lis.add(key);
      lis2.add(temp2['category']);
      if (temp2['result'] == null) {
        lis3.add(' ');
      } else {
        lis3.add(temp2['result']);
      }
    });
    return [lis, lis2, lis3];
  }

  List<dynamic> _getListResultOfURL() {
    var temp = _jsonMp['scans'];
    var temp2 = {};
    List lis = [];
    List lis2 = [];
    Map map = {};
    temp.forEach((key, value) {
      temp2 = value;
      map.putIfAbsent(key, () => temp2['result']);
      lis.add(key);
      lis2.add(temp2['result']);
    });
    return [lis, lis2];
  }
}
