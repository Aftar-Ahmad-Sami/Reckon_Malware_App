import 'package:firebase_auth/firebase_auth.dart';
import 'package:flutter/material.dart';
import 'package:path_provider/path_provider.dart';

import 'package:get/get.dart';
import 'package:reckonmalware/views/feedback_page.dart';
import 'package:reckonmalware/views/supporting/url_shortener.dart';

import '../views/core_pages/auth/sign_in.dart';
import '../views/core_pages/domain_checking.dart';
import '../views/core_pages/file_report_checker.dart';
import '../views/core_pages/file_upload.dart';
import '../views/core_pages/ip_address_check.dart';
import '../views/core_pages/large_file_upload.dart';
import '../views/core_pages/scan_url.dart';
import 'snackbar.dart';

class UniformDrawer extends StatelessWidget {
  const UniformDrawer({Key? key}) : super(key: key);
  @override
  Widget build(BuildContext context) {
    return Drawer(
      child: ListView(
        padding: EdgeInsets.zero, //removes padding from ListView
        children: [
          UserAccountsDrawerHeader(
            decoration: BoxDecoration(color: Color.fromARGB(255, 189, 174, 45)),
            accountName: Text("Aftar Ahmad Sami"),
            accountEmail: Text("aftarahmadsami@gmail.com"),
            currentAccountPicture: Container(
              // color: Colors.red,
              width: 200,
              height: 200,
              child: Image.asset(
                'assets/icons/drawer_icon.png',
                // width: 50,
                // height: 200,
                // fit: BoxFit.fill,
              ),
            ),
          ),
          ListTile(
            title: const Text("Get File Report"),
            onTap: () {
              Get.to(const FileReport());
            },
          ),
          ListTile(
            title: const Text("File Upload"),
            onTap: () {
              Get.to(const FileUpload());
            },
          ),
          ListTile(
            title: const Text("Large File Upload"),
            onTap: () {
              Get.to(const LargeFileUpload());
            },
          ),
          ListTile(
            title: const Text("Scan URL"),
            onTap: () {
              Get.to(const ScanURL());
            },
          ),
          ListTile(
            title: const Text("Scan IP Address"),
            onTap: () {
              Get.to(const IpAddressChecking());
            },
          ),
          ListTile(
            title: const Text("Scan Domain"),
            onTap: () {
              Get.to(const DomainChecking());
            },
          ),
          ListTile(
            title: const Text("URL Shortener"),
            onTap: () {
              Get.to(const UrlShortener());
            },
          ),
          ListTile(
            title: const Text("Feedback"),
            onTap: () {
              Get.to(const FeedbackPage());
            },
          ),
          ListTile(
            title: const Text("Clean Cache"),
            onTap: () {
              _deleteCacheDDir();
              Navigator.pop(context);
              ScaffoldMessenger.of(context).showSnackBar(cleanedSnackBar());
            },
          ),
          ListTile(
            title: const Text("Log Out"),
            onTap: () {
              FirebaseAuth.instance.signOut();
              Navigator.pop(context);
              Navigator.push(
                context,
                MaterialPageRoute(builder: (context) => const SignIn()),
              );
            },
          ),
          const AboutListTile(
            icon: Icon(
              Icons.info,
            ),
            applicationIcon:
                Icon(Icons.shield, color: Color(0xff218150), size: 50),
            applicationName: 'Reckon Malware',
            applicationVersion: '1.0.0',
            applicationLegalese: 'Copyright Â© 2022',
            child: Text("About Reckon Malware"),
          ),
        ],
      ),
    );
  }

  Future<void> _deleteCacheDDir() async {
    final cacheDir = await getTemporaryDirectory();

    if (cacheDir.existsSync()) {
      cacheDir.deleteSync(recursive: true);
    }
  }
}
